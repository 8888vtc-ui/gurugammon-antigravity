  console.log
    [dotenv@17.2.3] injecting env (0) from .env -- tip: ­ƒöÉ encrypt with Dotenvx: https://dotenvx.com

      at _log (node_modules/dotenv/lib/main.js:142:11)

  console.error
    CRITICAL: ACCESS_TOKEN_SECRET missing in development environment. Using fallback secret. Snapshot: no SECRET-like environment variables detected

    [0m [90m 20 |[39m   [36mconst[39m secret [33m=[39m process[33m.[39menv[envKey][33m;[39m
     [90m 21 |[39m   [36mif[39m ([33m![39msecret) {
    [31m[1m>[22m[39m[90m 22 |[39m     console[33m.[39merror([32m`CRITICAL: ${envKey} missing in ${isProduction ? 'production' : 'development'} environment. Using fallback secret. Snapshot:`[39m[33m,[39m formatSecretSnapshot())[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 23 |[39m     [36mreturn[39m fallback[33m;[39m
     [90m 24 |[39m   }
     [90m 25 |[39m   [36mreturn[39m secret[33m;[39m[0m

      at resolveSecret (src/config/index.ts:22:13)
      at Object.<anonymous> (src/config/index.ts:225:22)
      at Object.<anonymous> (src/services/gameService.ts:20:1)
      at Object.<anonymous> (src/services/tournamentService.ts:8:1)
      at Object.<anonymous> (tests/tournament/tournamentService.test.ts:1:1)

  console.error
    CRITICAL: REFRESH_TOKEN_SECRET missing in development environment. Using fallback secret. Snapshot: no SECRET-like environment variables detected

    [0m [90m 20 |[39m   [36mconst[39m secret [33m=[39m process[33m.[39menv[envKey][33m;[39m
     [90m 21 |[39m   [36mif[39m ([33m![39msecret) {
    [31m[1m>[22m[39m[90m 22 |[39m     console[33m.[39merror([32m`CRITICAL: ${envKey} missing in ${isProduction ? 'production' : 'development'} environment. Using fallback secret. Snapshot:`[39m[33m,[39m formatSecretSnapshot())[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 23 |[39m     [36mreturn[39m fallback[33m;[39m
     [90m 24 |[39m   }
     [90m 25 |[39m   [36mreturn[39m secret[33m;[39m[0m

      at resolveSecret (src/config/index.ts:22:13)
      at Object.<anonymous> (src/config/index.ts:226:23)
      at Object.<anonymous> (src/services/gameService.ts:20:1)
      at Object.<anonymous> (src/services/tournamentService.ts:8:1)
      at Object.<anonymous> (tests/tournament/tournamentService.test.ts:1:1)

  console.error
    CRITICAL: ACCESS_TOKEN_SECRET missing in development environment. Using fallback secret. Snapshot: no SECRET-like environment variables detected

    [0m [90m 20 |[39m   [36mconst[39m secret [33m=[39m process[33m.[39menv[envKey][33m;[39m
     [90m 21 |[39m   [36mif[39m ([33m![39msecret) {
    [31m[1m>[22m[39m[90m 22 |[39m     console[33m.[39merror([32m`CRITICAL: ${envKey} missing in ${isProduction ? 'production' : 'development'} environment. Using fallback secret. Snapshot:`[39m[33m,[39m formatSecretSnapshot())[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 23 |[39m     [36mreturn[39m fallback[33m;[39m
     [90m 24 |[39m   }
     [90m 25 |[39m   [36mreturn[39m secret[33m;[39m[0m

      at resolveSecret (src/config/index.ts:22:13)
      at Object.<anonymous> (src/config/index.ts:229:14)
      at Object.<anonymous> (src/services/gameService.ts:20:1)
      at Object.<anonymous> (src/services/tournamentService.ts:8:1)
      at Object.<anonymous> (tests/tournament/tournamentService.test.ts:1:1)

  console.warn
    WARNING: DATABASE_URL is not set. Prisma will fail to connect.

    [0m [90m 33 |[39m       [36mthrow[39m [36mnew[39m [33mError[39m(message)[33m;[39m
     [90m 34 |[39m     }
    [31m[1m>[22m[39m[90m 35 |[39m     console[33m.[39mwarn([32m`WARNING: ${message}`[39m)[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 36 |[39m   }
     [90m 37 |[39m   [36mreturn[39m url [33m?[39m[33m?[39m [32m'postgresql://localhost:5432/gammon_dev'[39m[33m;[39m
     [90m 38 |[39m }[33m;[39m[0m

      at resolveDatabaseUrl (src/config/index.ts:35:13)
      at Object.<anonymous> (src/config/index.ts:230:16)
      at Object.<anonymous> (src/services/gameService.ts:20:1)
      at Object.<anonymous> (src/services/tournamentService.ts:8:1)
      at Object.<anonymous> (tests/tournament/tournamentService.test.ts:1:1)

  console.error
    CRITICAL: SESSION_TOKEN_SECRET missing in development environment. Using fallback secret. Snapshot: no SECRET-like environment variables detected

    [0m [90m 20 |[39m   [36mconst[39m secret [33m=[39m process[33m.[39menv[envKey][33m;[39m
     [90m 21 |[39m   [36mif[39m ([33m![39msecret) {
    [31m[1m>[22m[39m[90m 22 |[39m     console[33m.[39merror([32m`CRITICAL: ${envKey} missing in ${isProduction ? 'production' : 'development'} environment. Using fallback secret. Snapshot:`[39m[33m,[39m formatSecretSnapshot())[33m;[39m
     [90m    |[39m             [31m[1m^[22m[39m
     [90m 23 |[39m     [36mreturn[39m fallback[33m;[39m
     [90m 24 |[39m   }
     [90m 25 |[39m   [36mreturn[39m secret[33m;[39m[0m

      at resolveSecret (src/config/index.ts:22:13)
      at resolveSessionConfig (src/config/index.ts:200:18)
      at Object.<anonymous> (src/config/index.ts:235:12)
      at Object.<anonymous> (src/services/gameService.ts:20:1)
      at Object.<anonymous> (src/services/tournamentService.ts:8:1)
      at Object.<anonymous> (tests/tournament/tournamentService.test.ts:1:1)

node.exe : FAIL tests/tournam
ent/tournamentService.test.ts
Au caractère Ligne:1 : 1
+ & "C:\Program 
Files\nodejs/node.exe" 
"C:\Program 
Files\nodejs/node_mo ...
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~~~~~~~~~~~~
    + CategoryInfo           
   : NotSpecified: (FAIL te  
  sts/tour...Service.test.   
 ts:String) [], RemoteExc    
eption
    + FullyQualifiedErrorId  
   : NativeCommandError
 
  TournamentService
    createTournament
      ÔêÜ creates a 
tournament and returns a 
summary payload (6 ms)
    joinTournament
      ÔêÜ persists the 
participant and increments 
metrics (1 ms)
    leaveTournament
      ÔêÜ removes the 
participant and increments 
metrics
    startTournament
      ├ù updates status, 
emits events and records 
metrics
    reportMatchResult
      ÔêÜ finalises match, 
broadcasts events and 
enqueues next round (1 ms)
    getUserRole
      ÔêÜ returns ORGANIZER 
when user created the 
tournament
      ÔêÜ returns PLAYER 
when user is registered (1 
ms)
      ÔêÜ returns SPECTATOR 
when user is not registered 
(1 ms)
      ÔêÜ throws if 
tournament does not exist (1 
ms)
    getStandings
      ÔêÜ computes wins, 
losses, and ordering (1 ms)
    getBracket
      ÔêÜ groups matches by 
round (1 ms)

  ÔùÅ TournamentService ÔÇ║ 
startTournament ÔÇ║ updates 
status, emits events and 
records metrics

    TypeError: Cannot read 
properties of undefined 
(reading 'length')

    [0m [90m 273 |[39m    
 [90m// Calculate 
scores[39m
     [90m 274 |[39m     
[36mconst[39m 
playersWithScores 
[33m=[39m 
participants[33m.[39mmap(p 
[33m=>[39m {
    
[31m[1m>[22m[39m[90m 
275 |[39m       
[36mconst[39m wins 
[33m=[39m p[33m.[39mwonMa
tches[33m.[39mlength[33m;
[39m
     [90m     |[39m        
                         
[31m[1m^[22m[39m
     [90m 276 |[39m       
[36mconst[39m byes 
[33m=[39m p[33m.[39mwhite
Matches[33m.[39mfilter(m 
[33m=>[39m [33m![39mm[33
m.[39mblackParticipantId 
[33m&&[39m m[33m.[39mwinn
erParticipantId 
[33m===[39m p[33m.[39mid)
[33m.[39mlength [33m+[39m
     [90m 277 |[39m        
 p[33m.[39mblackMatches[33
m.[39mfilter(m [33m=>[39m 
[33m![39mm[33m.[39mwhiteP
articipantId [33m&&[39m m[
33m.[39mwinnerParticipantId 
[33m===[39m p[33m.[39mid)
[33m.[39mlength[33m;[39m
     [90m 278 |[39m       
[36mreturn[39m { 
[33m...[39mp[33m,[39m 
score[33m:[39m wins 
[33m+[39m byes 
}[33m;[39m[0m

      at src/services/tournam
entService.ts:275:33
          at Array.map 
(<anonymous>)
      at TournamentService.ge
neratePairings (src/services/
tournamentService.ts:274:44)
      at async TournamentServ
ice.startTournament (src/serv
ices/tournamentService.ts:254
:5)
      at async 
Object.<anonymous> (tests/tou
rnament/tournamentService.tes
t.ts:296:7)

Test Suites: 1 failed, 1 
total
Tests:       1 failed, 10 
passed, 11 total
Snapshots:   0 total
Time:        1.515 s
Ran all test suites matching 
/tests\\tournament\\tournamen
tService.test.ts/i.
